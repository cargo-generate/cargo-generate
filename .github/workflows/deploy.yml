name: Deploy
on:
    push:
        branches:  [ '*' ]
    pull_request:

jobs:
    pages:
        name: GitHub Pages
        runs-on: ubuntu-latest
        steps:
            -   uses: actions/checkout@master
            -   name: Install Rust (rustup)
                run: rustup update stable --no-self-update && rustup default stable
            -   name: Install mdbook
                run: cargo install mdbook
            -   name: Build book
                run: mdbook build guide
            -   name: Deploy to GitHub
                env:
                    GITHUB_DEPLOY_KEY: ${{ secrets.GITHUB_DEPLOY_KEY }}
                run: |
                    touch guide/book/.nojekyll
                    curl -LsSf https://raw.githubusercontent.com/rust-lang/simpleinfra/master/setup-deploy-keys/src/deploy.rs | rustc - -o /tmp/deploy
                    cd guide/book
                    /tmp/deployÔ∏è
