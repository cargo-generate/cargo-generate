<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Cargo Generate Documentation</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="cargo, make me a project">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Cargo Generate Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/cargo-generate/cargo-generate/tree/main/guide" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<blockquote>
<p>cargo, make me a project</p>
</blockquote>
<p><a href="https://github.com/cargo-generate/cargo-generate/actions?query=workflow%3ABuild+branch%3Amain+"><img src="https://github.com/cargo-generate/cargo-generate/workflows/Build/badge.svg" alt="Build status" /></a>
<a href="https://crates.io/crates/cargo-generate"><img src="https://img.shields.io/crates/v/cargo-generate.svg" alt="crates.io" /></a>
<a href="https://deps.rs/repo/github/cargo-generate/cargo-generate"><img src="https://deps.rs/repo/github/cargo-generate/cargo-generate/status.svg" alt="dependency status" /></a></p>
<p><code>cargo-generate</code> is a developer tool to help you get up and running quickly with a new Rust
project by leveraging a pre-existing git repository as a template.</p>
<p>cargo-generate uses <a href="http://liquidmarkup.org/">Shopify's Liquid</a> template language,
<a href="https://docs.rs/rhai/latest/rhai/">Rhai</a> for hook scripts and <a href="https://docs.rs/regex/latest/regex/">regex</a> for placeholders.</p>
<p>Due to the use of <a href="http://liquidmarkup.org/">Shopify's Liquid</a>, <code>cargo-generate</code> special cases files with the file-ending
<code>.liquid</code>, by simply removing the file-ending when processing the files. If you, as a template
author, truly want the <code>.liquid</code> file-ending, you need to repeat it twice!</p>
<p>For example: The file <code>README.md.liquid</code> will be renamed after templating to <code>README.md</code>.
If <code>README.md</code> already exists, then it will be overwritten to include the contents of <code>README.md.liquid</code>.</p>
<p>Here's an example of using <code>cargo-generate</code> with <a href="https://github.com/rustwasm/wasm-pack-template">this template</a>:</p>
<p><img src="./demo.gif" alt="demo.gif" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<h2 id="using-cargo-generate-with-vendored-libgit2-and-systems-openssl"><a class="header" href="#using-cargo-generate-with-vendored-libgit2-and-systems-openssl">Using <code>cargo-generate</code> with vendored <code>libgit2</code> and system's OpenSSL</a></h2>
<p>By default, cargo-generate uses vendored sources for <code>libgit2</code> and OpenSSL that is installed on your system.</p>
<pre><code class="language-sh">cargo install cargo-generate
</code></pre>
<p>This requires the following dependencies on your system:</p>
<ul>
<li><code>libssl-dev</code> (this could also be named openssl)</li>
</ul>
<h2 id="using-cargo-generate-with-vendored-openssl"><a class="header" href="#using-cargo-generate-with-vendored-openssl">Using <code>cargo-generate</code> with vendored OpenSSL</a></h2>
<p>However, you can also opt in to use a vendored OpenSSL version.
So that you don't have to have OpenSSL installed and built it on the spot.</p>
<p>this would require the following dependencies on your system, as documented by the <a href="https://docs.rs/openssl"><code>openssl</code> crate</a>:</p>
<ul>
<li>A C compiler (<code>gcc</code>, for example)</li>
<li><code>perl</code> and <code>perl-core</code></li>
<li><code>make</code></li>
</ul>
<pre><code class="language-sh">cargo install cargo-generate --features vendored-openssl
</code></pre>
<h2 id="using-cargo-generate-with-systems-libgit2-and-systems-openssl"><a class="header" href="#using-cargo-generate-with-systems-libgit2-and-systems-openssl">Using <code>cargo-generate</code> with system's <code>libgit2</code> and system's OpenSSL</a></h2>
<p>You can opt-out of vendored libraries and use <code>libgit2</code> and OpenSSL from your system
by building cargo-generate without the default dependencies.</p>
<pre><code class="language-sh">cargo install cargo-generate --no-default-features
</code></pre>
<p>This will require the following dependencies on your system:</p>
<ul>
<li><code>pkg-config</code></li>
<li><code>libgit2</code></li>
<li><code>libssl-dev</code> (this could also be named openssl)</li>
</ul>
<h2 id="using-pacman-arch-linux"><a class="header" href="#using-pacman-arch-linux">Using <code>pacman</code> (Arch Linux)</a></h2>
<p><code>cargo-generate</code> can be installed from the <a href="https://archlinux.org/packages/extra/x86_64/cargo-generate/">extra repository</a> for Arch Linux:</p>
<pre><code class="language-sh">pacman -S cargo-generate
</code></pre>
<h2 id="manual-installation"><a class="header" href="#manual-installation">Manual Installation</a></h2>
<ol>
<li>Download the binary tarball for your platform from our <a href="https://github.com/cargo-generate/cargo-generate/releases">releases page</a>.</li>
<li>Unpack the tarball and place the binary <code>cargo-generate</code> in <code>~/.cargo/bin/</code></li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="usage"><a class="header" href="#usage">Usage</a></h1>
<p>Standard usage is to pass a <code>--git</code> flag to <code>cargo generate</code> or short <code>cargo gen</code>. This will prompt you to enter the name of your project.</p>
<blockquote>
<p>⚠️ NOTE: <code>cargo gen</code> requires a <a href="usage/index.html#cargo-gen---alias">cargo alias configuration</a></p>
</blockquote>
<pre><code class="language-sh">cargo generate username-on-github/mytemplate
# is the same as
cargo generate gh:username-on-github/mytemplate
# is the same as
cargo generate --git https://github.com/username-on-github/mytemplate.git
</code></pre>
<p>If you have your templates not GitHub then you can leverage the lazy abbreviation prefixes:</p>
<pre><code class="language-sh"># for gitlab.com
cargo generate gl:username-on-gitlab/mytemplate # translates to https://gitlab.com/username-on-gitlab/mytemplate.git
# or for bitbucket.org
cargo generate bb:username-on-bitbucket/mytemplate # translates to https://bitbucket.org/username-on-bitbucket/mytemplate.git
# or for github.com
cargo generate gh:username-on-github/mytemplate # translates to https://github.com/username-on-github/mytemplate.git
# or for git.sr.ht
cargo generate sr:username-on-sourcehut/mytemplate # translates to https://git.sr.ht/~username-on-sourcehut/mytemplate (note the tilde)
</code></pre>
<p>Both will expand to the <code>https</code> urls of the repo with the suffix <code>.git</code> in the URL.</p>
<p>You can also pass the name of your project to the tool using the <code>--name</code> or <code>-n</code> flag:</p>
<pre><code class="language-sh">cargo generate --git https://github.com/username-on-github/mytemplate.git --name myproject
</code></pre>
<h2 id="templates-in-subfolders"><a class="header" href="#templates-in-subfolders">Templates in subfolders</a></h2>
<p>If the repository or path specified for the template contains multiple templates (Any sub-folder that contains a <code>cargo-generate.toml</code> file), <code>cargo-generate</code> will ask for the specific folder to be used as the template.</p>
<p>Multiple <em>sub-templates</em> can also be configured in the <code>cargo-generate.toml</code> file like this:</p>
<pre><code class="language-toml">[template]
sub_templates = ["folder1", "folder2"]
</code></pre>
<p>Doing so also sets the order when <code>cargo-generate</code> asks what to expand, while the first option will be the default.</p>
<p>The specific subfolder in the git repository may be specified on the command line like this:</p>
<pre><code class="language-sh">cargo generate --git https://github.com/username-on-github/mytemplate.git &lt;relative-template-path&gt;
</code></pre>
<blockquote>
<p>⚠️ NOTE: When using the <code>subfolder</code> feature, <code>cargo-generate</code> will search for the <code>cargo-generate.toml</code> file in the subfolder first, traversing back towards the template root in case it is not found.</p>
</blockquote>
<h2 id="generating-into-current-dir"><a class="header" href="#generating-into-current-dir">Generating into current dir</a></h2>
<p>If the user wants to generate a template straight into the current folder, without creating a subfolder for the contents and without attempting to initialize a <code>.git</code> repo or similar, the <code>--init</code> flag can be used.</p>
<pre><code class="language-sh">cargo generate --init --git https://github.com/username-on-github/mytemplate.git
</code></pre>
<blockquote>
<p>⚠️ NOTE: <code>cargo-generate</code> will not allow any existing files to be overwritten and will fail to generate any files should there be any conflicts.</p>
</blockquote>
<h2 id="generating-using-a-local-template"><a class="header" href="#generating-using-a-local-template">Generating using a local template</a></h2>
<p>You can generate a project using a local template via the <code>--path</code> flag:</p>
<pre><code class="language-sh">git clone https://github.com/username-on-github/mytemplate.git $HOME/mytemplate # Clone any template
cargo generate --path $HOME/mytemplate # Use it locally
</code></pre>
<blockquote>
<p>⚠️ NOTE: <code>cargo-generate</code> will not allow to use the association <code>--path</code> and <code>--git</code> flags.</p>
</blockquote>
<h2 id="https-proxy"><a class="header" href="#https-proxy">Http(s) proxy</a></h2>
<p>New in version <a href="https://github.com/cargo-generate/cargo-generate/releases/tag/v0.7.0">0.7.0</a> is automatic proxy usage. So, if http(s)_PROXY env variables are provided, they
will be used for cloning a http(s) template repository.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="git-over-ssh"><a class="header" href="#git-over-ssh">Git over SSH</a></h1>
<p>New in version <a href="https://github.com/cargo-generate/cargo-generate/releases/tag/v0.7.0">0.7.0</a> is the support for both public and private and ssh git remote urls.
New in version <a href="https://github.com/cargo-generate/cargo-generate/releases/tag/v0.22.0">0.22.0</a> is the support for <code>ssh-agent</code> on Windows and interactively asking for passphrase for password protected keys on *Nix and macOS.</p>
<p>There are 2 different git over ssh urls, one with the <code>git@</code> prefix and one with the <code>ssh://</code> prefix. Both are supported. Please note that the <code>ssh://</code> prefix url uses a path where the <code>git@</code> prefix uses a colon at the user/github-org level. For example:</p>
<pre><code class="language-raw">git@github.com:rustwasm/wasm-pack-template.git

# vs

ssh://git@github.com/rustwasm/wasm-pack-template.git
</code></pre>
<p>Both those urls can also be used in the <code>.gitconfig</code> insteadOf configuration, see more in the section below.</p>
<pre><code class="language-sh">cargo generate --git git@github.com:rustwasm/wasm-pack-template.git --name mywasm
</code></pre>
<h2 id="authentication-using-ssh-agent"><a class="header" href="#authentication-using-ssh-agent">Authentication using <code>ssh-agent</code></a></h2>
<p>New in version <a href="https://github.com/cargo-generate/cargo-generate/releases/tag/v0.15.1">0.15.1</a> is the <code>ssh-agent</code> usage for password protected keys. It's also the default mechanism on Windows.</p>
<h3 id="on-windows"><a class="header" href="#on-windows">On Windows</a></h3>
<p><code>ssh-agent</code> is the default and also <strong>the only</strong> possibility to get git+ssh working.
Please follow <a href="https://github.com/cargo-generate/cargo-generate/discussions/653">this guide</a> to get <code>ssh-agent</code> configured on windows.</p>
<h3 id="on-nix-and-macos"><a class="header" href="#on-nix-and-macos">On *Nix and macOS</a></h3>
<p>If you omit the identity file (read the next paragraph) <strong>OR</strong> a provided identity file does not exist, then the default is to use <code>ssh-agent</code>.</p>
<h2 id="ssh-identity-file-defaults"><a class="header" href="#ssh-identity-file-defaults">Ssh identity file defaults</a></h2>
<p>Since version <a href="https://github.com/cargo-generate/cargo-generate/releases/tag/v0.22.0">0.22.0</a> the default mechanism on unix/macOS is to use the function <a href="https://github.com/de-vri-es/auth-git2-rs/blob/fd6502e20b9e82063b950ac9e32f6454341e71f2/src/lib.rs#L344"><code>add_default_ssh_keys</code></a> that adds a couple of default keys to look up first.</p>
<pre><code>// the list used..
let candidates = [
			"id_rsa",
			"id_ecdsa,",
			"id_ecdsa_sk",
			"id_ed25519",
			"id_ed25519_sk",
			"id_dsa",
		];
</code></pre>
<h2 id="custom-ssh-identity-file-private-key"><a class="header" href="#custom-ssh-identity-file-private-key">Custom ssh identity file (private key)</a></h2>
<p>However, if you use a different file, you can pass a custom ssh identity with via <code>-i | --identity</code> like <code>-i ~/.ssh/id_rsa_other</code> as argument.</p>
<p>If the file is passphrase protected cargo-generate will ask for the passphrase interactively.</p>
<p>If you permanently want to use a custom identity file, you can configure it in the cargo-generate config file like this:</p>
<pre><code class="language-toml"># an extract of ~/.cargo/cargo-generate.toml
[defaults]
# note that `~/` and `$HOME/` are going to be expanded to the full path seamlessly
ssh_identity = "~/.ssh/id_rsa_other"
# that is equivalent to
ssh_identity = "$HOME/.ssh/id_rsa_other"
# that is equivalent to
ssh_identity = "/home/john/.ssh/id_rsa_other"
</code></pre>
<blockquote>
<p>⚠️ NOTE: that the cli argument <code>-i</code> always overrules the <code>ssh_identity</code> from the config file.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gitconfig-and-insteadof-configuration"><a class="header" href="#gitconfig-and-insteadof-configuration"><code>.gitconfig</code> and <code>insteadOf</code> configuration</a></h1>
<p>⚠️ New in version <a href="https://github.com/cargo-generate/cargo-generate/releases/tag/v0.22.0">0.22.0</a></p>
<p>git supports a magic trick to rewrite urls on the fly. This is done by adding a <code>url.&lt;base&gt;.insteadOf</code> configuration to your <code>.gitconfig</code> file.</p>
<p>In cargo-generate this is supported as well.</p>
<p>For example, if you prefer the ssh over the https urls and you want to use <code>cargo-generate</code> with it, you can add the following to your <code>.gitconfig</code>:</p>
<pre><code class="language-.gitconfig"># ~/.gitconfig

[url "git@github.com:"]
insteadOf = https://github.com/
</code></pre>
<p>and then you can use <code>cargo-generate</code> with the <code>https</code> url:</p>
<pre><code class="language-sh">RUST_LOG=debug cargo generate https://github.com/Rahix/avr-hal-template.git

🔧   gitconfig 'insteadOf' lead to this url: git@github.com:Rahix/avr-hal-template.git

...
</code></pre>
<p>In this case please notice the ssh url is <code>git@github.com:</code> if you prefer the more explicit notation you can also write it like this:</p>
<pre><code class="language-.gitconfig"># ~/.gitconfig

[url "ssh://git@github.com/"]
insteadOf = https://github.com/
</code></pre>
<p>that would lead to the same result, with slightly different url:</p>
<pre><code class="language-sh">RUST_LOG=debug cargo generate https://github.com/Rahix/avr-hal-template.git

🔧   gitconfig 'insteadOf' lead to this url: ssh://git@github.com/Rahix/avr-hal-template.git

...
</code></pre>
<blockquote>
<p>⚠️ NOTE: <code>RUST_LOG=debug</code> would allow you to see the rewritten url in the output.</p>
</blockquote>
<p>In cases where you have a different <code>.gitconfig</code> location, you can use the <code>--gitconfig</code> argument to specify the path to the <code>.gitconfig</code> file, like this:</p>
<pre><code class="language-sh">$ cd /path/to/my/workspace
$ cat .gitconfig
[url "git@github.com:"]
insteadOf = https://github.com/

$ cargo generate --gitconfig ./.gitconfig https://github.com/Rahix/avr-hal-template.git
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="favorites"><a class="header" href="#favorites">Favorites</a></h1>
<p>Favorite templates can be defined in a config file, that by default is placed at <code>$CARGO_HOME/cargo-generate.toml</code> or <code>$CARGO_HOME/cargo-generate</code>.
To specify an alternate configuration file, use the <code>--config &lt;config-file&gt;</code> option.</p>
<blockquote>
<p>⚠️ NOTE: A relative <code>--config</code> option, will be relative to the template root during expansion.</p>
</blockquote>
<p>Each favorite template is specified in its own section, e.g.:</p>
<pre><code class="language-toml">[favorites.demo]
description = "&lt;optional description, visible with --list-favorites&gt;"
git = "https://github.com/rustwasm/wasm-pack-template"
branch = "&lt;optional-branch&gt;"
subfolder = "&lt;optional-subfolder&gt;"
vcs = "&lt;optional: None|Git&gt;"
init = optional true|false
overwrite = optional true|false
</code></pre>
<p>Values may be overridden using the CLI arguments of the same names (e.g. <code>--subfolder</code> for the <code>subfolder</code> value).</p>
<p><strong>Note:</strong> Specifying <code>init = true</code> has the effect of forcing the template to exhibit behaviour as if <code>--init</code> is specified on the
commandline, as there is no counter-option!</p>
<p><strong>Note:</strong> Specifying <code>overwrite = true</code> has the effect of allowing the template to always overwrite files as there is no counter-option!</p>
<p>When favorites are available, they can be generated simply by invoking:</p>
<pre><code class="language-cli">cargo gen &lt;favorite&gt;
</code></pre>
<p>or slightly more involved:</p>
<pre><code class="language-cli">cargo generate demo --branch mybranch --name expanded_demo --subfolder myfolder
</code></pre>
<blockquote>
<p>⚠️ NOTE: when <code>&lt;favorite&gt;</code> is not defined in the config file, it is interpreted as a git repo like as if <code>--git &lt;favorite&gt;</code></p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="templates"><a class="header" href="#templates">Templates</a></h1>
<h2 id="placeholders"><a class="header" href="#placeholders">Placeholders</a></h2>
<p>Templates are git repositories whose files can contain placeholders. A placeholder can be seen as
a variable that is substituted by another value upon expansion of the template.</p>
<p><code>cargo-generate</code> supports both builtin variables/placeholders and custom defined ones.</p>
<p>Additionally, <strong>all filters and tags</strong> of the liquid template language are supported.
For more information, check out the <a href="https://shopify.github.io/liquid">Liquid Documentation on <code>Tags</code> and <code>Filters</code></a>.</p>
<p>You can use those placeholders in the file and directory names of the generated project.
For example, for a project named <code>awesome</code>, the filename <code>{{project-name}}/{{project-name}}.rs</code> will be transformed to <code>awesome/awesome.rs</code> during generation.
Only files that are <strong>not</strong> listed in the exclude settings will be templated.</p>
<blockquote>
<p>⚠️ NOTE: invalid characters for a filename or directory name will be sanitized after template substitution. Invalid is e.g. <code>/</code> or <code>\</code>.</p>
</blockquote>
<blockquote>
<p>⚠️ <strong>Deprecated</strong> in favor of using <a href="templates/index.html#Ignoring-files">ignore in <code>cargo-generate.toml</code></a></p>
<p>You can also add a <code>.genignore</code> file to your template. The files listed in the <code>.genignore</code> file
will be removed from the local machine when <code>cargo-generate</code> is run on the end user's machine.
The <code>.genignore</code> file is always ignored, so there is no need to list it in the <code>.genignore</code> file.</p>
</blockquote>
<h3 id="additional-liquid-filters"><a class="header" href="#additional-liquid-filters">Additional <code>liquid</code> filters</a></h3>
<p>Following are filters that <code>cargo-generate</code> expands the <code>liquid</code> language with.</p>
<ul>
<li>
<p><strong><code>rhai</code></strong></p>
<p>Tries to run the argument as a <code>rhai</code> script. Whatever the script returns will be the output of
the filter.</p>
<p>Example Liquid:</p>
<pre><code class="language-liquid">Here we try to run a rhai script: {{"script_name.rhai" | rhai}}
</code></pre>
<blockquote>
<p>⚠️ NOTE: <code>Liquid</code> does not support failing filters, thus if the script fails for any reason,
<code>cargo-generate</code> will simply print a warning message to stderr, and <code>Liquid</code> will leave
the substitution in its original form.</p>
</blockquote>
</li>
<li>
<p><strong><code>kebab_case</code></strong></p>
<p><code>"We are going to inherit the earth."</code> =&gt; <code>"we-are-going-to-inherit-the-earth"</code></p>
</li>
<li>
<p><strong><code>lower_camel_case</code></strong></p>
<p><code>"It is we who built these palaces and cities."</code> =&gt; <code>"itIsWeWhoBuiltThesePalacesAndCities"</code></p>
</li>
<li>
<p><strong><code>pascal_case</code></strong></p>
<p>Same as <code>upper_camel_case</code></p>
</li>
<li>
<p><strong><code>shouty_kebab_case</code></strong></p>
<p><code>"We are going to inherit the earth."</code> =&gt; <code>"WE-ARE-GOING-TO-INHERIT-THE-EARTH"</code></p>
</li>
<li>
<p><strong><code>shouty_snake_case</code></strong></p>
<p><code>"That world is growing in this minute."</code> =&gt; <code>"THAT_WORLD_IS_GROWING_IN_THIS_MINUTE"</code></p>
</li>
<li>
<p><strong><code>snake_case</code></strong></p>
<p><code>"We carry a new world here, in our hearts."</code> =&gt; <code>"we_carry_a_new_world_here_in_our_hearts"</code></p>
</li>
<li>
<p><strong><code>title_case</code></strong></p>
<p><code>"We have always lived in slums and holes in the wall."</code> =&gt; <code>"We Have Always Lived In Slums And Holes In The Wall"</code></p>
</li>
<li>
<p><strong><code>upper_camel_case</code></strong></p>
<p><code>"We are not in the least afraid of ruins."</code> =&gt; <code>"WeAreNotInTheLeastAfraidOfRuins"</code></p>
</li>
</ul>
<h2 id="templates-by-the-community"><a class="header" href="#templates-by-the-community">Templates by the community</a></h2>
<p>It's encouraged to classify your template repository <a href="https://docs.github.com/en/github/administering-a-repository/managing-repository-settings/classifying-your-repository-with-topics">with a GitHub topic</a> labeled <code>cargo-generate</code>.</p>
<p>So that every developer can find the template via <a href="https://github.com/topics/cargo-generate">cargo-generate topic on GitHub</a>.</p>
<p>If you have a great template, please tag your repository with the topic <a href="https://twitter.com/intent/tweet?text=See%20my%20new%20%23cargogenerate%20%23template%20%0A%0A%3E%20your%20link%20goes%20here">and tweet about it</a> by including the hashtag <a href="https://twitter.com/search?q=%23cargogenerate&amp;src=typed_query"><code>#cargogenerate</code></a> (since twitter does not support hashtags with <code>-</code>).</p>
<blockquote>
<p>⚠️ Note: the list of <a href="https://github.com/cargo-generate/cargo-generate/blob/main/TEMPLATES.md">currently available templates</a> is still available, but is now deprecated.</p>
</blockquote>
<h3 id="example-for---bin-and---lib"><a class="header" href="#example-for---bin-and---lib">Example for <code>--bin</code> and <code>--lib</code></a></h3>
<p>A template could be prepared in a way to act as a binary or a library. For example the <code>Cargo.toml</code> might look like:</p>
<pre><code class="language-toml">[package]
# the usual stuff

[dependencies]
{% if crate_type == "bin" %}
structopt = "0.3.21"
{% endif %}
# other general dependencies

{% if crate_type == "bin" %}
[[bin]]
path = "src/main.rs"
name = "{{crate_name}}-cli"
{% endif %}
</code></pre>
<p>Now a user of this template could decide weather they want the binary version by passing <code>--bin</code>
or use only the library version by passing <code>--lib</code> as a command line argument.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="builtin-placeholders"><a class="header" href="#builtin-placeholders">Builtin placeholders</a></h1>
<p><code>cargo-generate</code> supports a number of builtin placeholders for use in templates.</p>
<p>These placeholders can be used directly in files using the <a href="https://shopify.github.io/liquid">Liquid language</a>, or from
<a href="https://rhai.rs/book/">Rhai scripts</a> using the syntax:</p>
<pre><code class="language-rhai">variable::get("placeholder name")
</code></pre>
<p>Builtin placeholders are:</p>
<ul>
<li><code>authors</code>
<ul>
<li>this will be filled in by a function borrowed from Cargo's source code, that determines your information from
Cargo's configuration. It will either be on the form <code>username &lt;email&gt;</code> or just plain <code>username</code>.</li>
</ul>
</li>
<li><code>project-name</code>
<ul>
<li>this is supplied by either passing the <code>--name</code> flag to the command or working with the interactive CLI to supply
a name. It can be provided in snake_case or dash-case, in all other cases it is converted to dash-case.</li>
<li>it can also be supplied via the environment variable <code>CARGO_GENERATE_VALUE_PROJECT_NAME</code> when running in <code>--silent</code> mode
<blockquote>
<p>⚠️ Note: the <code>--force</code> flag allows you to use the project name as it is given, without adjusting. Please use it carefully.</p>
</blockquote>
</li>
</ul>
</li>
<li><code>crate_name</code>
<ul>
<li>the snake_case_version of <code>project-name</code></li>
</ul>
</li>
<li><code>crate_type</code>
<ul>
<li>this is supplied by either passing the <code>--bin</code> or <code>--lib</code> flag to the command line, contains either <code>bin</code>
or <code>lib</code>, <code>--bin</code> is the default</li>
</ul>
</li>
<li><code>os-arch</code>
<ul>
<li>contains the current operating system and architecture ex: <code>linux-x86_64</code></li>
</ul>
</li>
<li><code>username</code>
<ul>
<li>this will be filled in by a function borrowed from Cargo's source code, that determines your information from
Cargo's
configuration.</li>
</ul>
</li>
<li><code>within_cargo_project</code>
<ul>
<li>A boolean with the value <code>true</code> if the template is being expanded inside a <code>Cargo</code> project. It's
a simple matter of whether <code>Cargo.toml</code> is present in any parent folder.</li>
</ul>
</li>
<li><code>is_init</code>
<ul>
<li>A boolean that reflects the value of the <code>--init</code> parameter of <code>cargo-generate</code>.</li>
</ul>
</li>
</ul>
<h2 id="usage-example"><a class="header" href="#usage-example">Usage example</a></h2>
<pre><code class="language-markdown">// README.md

This awesome crate `{{ crate_name }}` is brought to you by {{ authors }}.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="template-defined-placeholders"><a class="header" href="#template-defined-placeholders">Template Defined Placeholders</a></h1>
<p>Template defined placeholders offer a powerful way for template authors to customize project templates and streamline project creation. In addition to defining placeholders directly within template files, users can also define placeholders in the <code>cargo-generate.toml</code> file, providing additional flexibility and customization options.</p>
<h2 id="defining-placeholders-in-cargo-generatetoml"><a class="header" href="#defining-placeholders-in-cargo-generatetoml">Defining Placeholders in <code>cargo-generate.toml</code></a></h2>
<p>To define placeholders in the <code>cargo-generate.toml</code> file, template authors can specify them under the <code>placeholders</code> section using the following syntax:</p>
<pre><code class="language-toml">[placeholders]
placeholder_name = { prompt = "Enter your name", choices = ["Alice", "Bob"], default = "Alice", type = "string" }
</code></pre>
<ul>
<li><code>placeholder_name</code>: The name of the placeholder.</li>
<li><code>prompt</code>: The prompt message displayed to the user during project creation.</li>
<li><code>choices</code> (optional): A list of predefined choices for the placeholder value.</li>
<li><code>default</code> (optional): The default value for the placeholder if no user input is provided.</li>
<li><code>regex</code> (optional and only for string-like types): The entered value is validated against this regex.</li>
<li><code>type</code>: The data type of the placeholder value (see <a href="templates/template_defined_placeholders.html#supported-types">Supported Types</a>).</li>
</ul>
<h2 id="prompt-choices-and-default-values"><a class="header" href="#prompt-choices-and-default-values">Prompt, Choices, and Default Values</a></h2>
<ul>
<li><strong>Prompt</strong>: With the <code>prompt</code> will be displayed it to the user during project creation, prompting them to provide a value for the placeholder.</li>
<li><strong>Choices</strong>: If <code>choices</code> are specified, <code>cargo-generate</code> will present them as options to the user, restricting the input to the predefined choices and provide more convenience.</li>
<li><strong>Default Value</strong>: If a <code>default</code> value is provided and the user does not provide input, <code>cargo-generate</code> will use the default value for the placeholder.</li>
</ul>
<h2 id="supported-types"><a class="header" href="#supported-types">Supported Types</a></h2>
<p><code>cargo-generate</code> supports the following placeholder value types:</p>
<ul>
<li><code>"string"</code>: Represents a string value.</li>
<li><code>"text"</code>: Represents a multiline string value. (terminated by hitting CTRL-D)</li>
<li><code>"editor"</code>: Represents a multiline string value, collected from the user by a real terminal editor.</li>
<li><code>"bool"</code>: Represents a boolean value (<code>true</code> or <code>false</code>).</li>
<li><code>"array"</code>: Represents an array of strings (<code>["a","b","c"]</code>)</li>
</ul>
<h2 id="example"><a class="header" href="#example">Example</a></h2>
<p>Consider the following <code>cargo-generate.toml</code> file:</p>
<pre><code class="language-toml">[placeholders]
project_name = { prompt = "Enter project name", default = "my_project", type = "string" }
environment = { prompt = "Which environment?", choices = ["dev", "prod"], default = "dev", type = "string"}
features = { prompt = "Include features?", choices = ["serde", "logging"], default = ["serde"], type = "array"}
use_git = { prompt = "Initialize Git repository?", default = true, type = "bool" }
phone_number = { prompt = "What's your phone number?", type = "string", regex = "^[0-9]+$" }
</code></pre>
<p>During project creation, <code>cargo-generate</code> will prompt the user to provide values for <code>project_name</code>, <code>use_git</code> and <code>phone_number</code> using the specified prompts, choices, and default values.</p>
<p>Further <code>phone_number</code> is validated against the provided regex, hence it can only contain digits.</p>
<h3 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h3>
<p>Template defined placeholders, defined in the <code>cargo-generate.toml</code> configuration file, offer powerful customization options for project templates. By specifying prompts, choices, default values, and supported types, template authors can create intuitive and flexible project scaffolding experiences, enhancing developer productivity and project consistency.</p>
<h2 id="default-values-for-placeholders"><a class="header" href="#default-values-for-placeholders">Default values for placeholders</a></h2>
<p>For automation purposes the user of the template may provide the values for the keys in the template using one or more of the following methods.</p>
<p>The methods are listed by falling priority.</p>
<h3 id="--define-or--d-flag"><a class="header" href="#--define-or--d-flag"><code>--define</code> or <code>-d</code> flag</a></h3>
<p>The user may specify variables individually using the <code>--define</code> flag.</p>
<pre><code class="language-sh">cargo generate template-above -n project-name -d hypervisor=qemu -d network_enabled=true
</code></pre>
<h3 id="--template_values_file-flag"><a class="header" href="#--template_values_file-flag"><code>--template_values_file</code> flag</a></h3>
<p>The user of the template may provide a file containing the values for the keys in the template by using the <code>--template-values-file</code> flag.</p>
<blockquote>
<p>⚠️ NOTE: A relative path will be relative to current working dir, which is <em>not</em> inside the expanding template!</p>
</blockquote>
<pre><code class="language-toml">[values]
hypervisor = "qemu"
network_enabled = true
</code></pre>
<h4 id="individual-values-via-environment-variables"><a class="header" href="#individual-values-via-environment-variables">Individual values via environment variables</a></h4>
<p>Variables may be specified using environment variables. To do so, set the env var <code>CARGO_GENERATE_VALUE_&lt;variable key&gt;</code> to the desired value.</p>
<pre><code class="language-sh">set CARGO_GENERATE_VALUE_HYPERVISOR=qemu
set CARGO_GENERATE_VALUE_NETWORK_ENABLED=true
cargo generate template-above
</code></pre>
<blockquote>
<p>⚠️ Windows does not support mixed case environment variables. Internally, <code>cargo-generate</code> will ensure the variable name is all lowercase. For that reason, it is strongly recommended that template authors only use lowercase variable/placeholder names.</p>
</blockquote>
<h4 id="template-values-file-via-environment-variable"><a class="header" href="#template-values-file-via-environment-variable">Template values file via environment variable</a></h4>
<p>The user may use the environment variable <code>CARGO_GENERATE_TEMPLATE_VALUES</code> to specify a file with default values.</p>
<p>For the file format, see above.</p>
<h4 id="default-values"><a class="header" href="#default-values">Default values</a></h4>
<p>Default values may be specified in the config file (specified with the <code>--config</code> flag, or in the default config file <code>$CARGO_HOME/cargo-generate</code>)</p>
<p><strong>Example config file:</strong></p>
<pre><code class="language-toml">[values]
placeholder1 = "default value"

[favorites.my_favorite]
git = "https://github.com/username-on-github/mytemplate.git"

[favorites.my_favorite.values]
placeholder1 = "default value overriding the default"
placeholder2 = "default value for favorite"
</code></pre>
<h2 id="further-examples"><a class="header" href="#further-examples">Further examples</a></h2>
<p>You can find further examples in the <a href="templates/./example-templates/">example-templates folder</a> you will find further examples that provide some template provided placeholders.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ignoring-files"><a class="header" href="#ignoring-files">Ignoring files</a></h1>
<p>The template author may choose to ignore files completely, by including an <code>ignore</code> list in the <code>cargo-generate.toml</code> file.</p>
<p>Example:</p>
<pre><code class="language-toml">[template]
ignore = [ 
  "file",
  "or folder",
  "to be ignored" 
]
</code></pre>
<p>Both files and folders may be ignored using this method, but currently wildcards are <strong>not supported</strong>.</p>
<p>Note that <code>cargo-generate</code> checks for which files to ignore after the removal of any <code>.liquid</code> file extensions.
Meaning; Setting <code>ignore</code> to <code>["file.txt"]</code> will result in the ignoring of a file named <code>file.txt.liquid</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="include--exclude"><a class="header" href="#include--exclude">Include / Exclude</a></h1>
<p>Templates support a <code>cargo-generate.toml</code>, with a "template" section that allows you to configure the files that will be processed by <code>cargo-generate</code>.
The behavior mirrors Cargo's Include / Exclude functionality, which is <a href="https://doc.rust-lang.org/cargo/reference/manifest.html#the-exclude-and-include-fields-optional">documented here</a>.
If you are using placeholders in a file name, and also wish to use placeholders in the contents of that file,
you should setup your globs to match on the pre-rename filename.</p>
<pre><code class="language-toml">[template]
include = ["Cargo.toml"]
# include and exclude are exclusive, if both appear we will use include
exclude = ["*.c"]
</code></pre>
<blockquote>
<p>⚠️ NOTE: <code>exclude</code> only makes <code>cargo-generate</code> ignore any <code>liquid</code> tags in the file. In order to exclude a file from being copied to the final dir, see <a href="templates/ignoring.html">ignoring files</a>.</p>
</blockquote>
<p>The <code>cargo-generate.toml</code> file should be placed in the root of the template. If using the <code>subfolder</code> feature, the root is the <code>subfolder</code> inside the repository, though <code>cargo-generate</code> will look for the file in all parent folders until it reaches the repository root.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="require-cargo-generate-version-from-template"><a class="header" href="#require-cargo-generate-version-from-template">Require <code>cargo-generate</code> version from template</a></h1>
<blockquote>
<p>Available since version <a href="https://github.com/cargo-generate/cargo-generate/releases/tag/v0.9.0">0.9.0</a></p>
</blockquote>
<p>Using the supported <code>cargo-generate.toml</code> file, the template author may setup version requirements towards <code>cargo-generate</code>.</p>
<pre><code class="language-toml">[template]
cargo_generate_version = "&gt;=0.9.0"
</code></pre>
<p>The format for the version requirement is <a href="https://doc.rust-lang.org/cargo/reference/specifying-dependencies.html">documented here</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="conditional-template-settings"><a class="header" href="#conditional-template-settings">Conditional template settings</a></h1>
<p>Using <code>cargo-generate.toml</code>, values and some [<code>Rhai</code>] syntax, the template author can make certain conditional decisions before expansion of the template.</p>
<p><code>include</code>, <code>exclude</code>, <code>ignore</code> and <code>placeholders</code> can all be used in sections that are only used based upon the value of one or more values, possibly input by the user using the interactive prompt (if the values in question are defined as placeholders in the non-conditional section).</p>
<p>Using the following example, <code>cargo-generate</code> will ask for the <code>license</code>, and depending on the <code>--lib</code> | <code>--bin</code> flags it'll as for the <code>hypervisor</code> and <code>network_enabled</code> values. It will then continue to expand the template, ignoring the <code>src/main.rs</code> file (and thus excluding it from the output) in case <code>--lib</code> was specified.</p>
<p>The example is broken up in order to explain each section.</p>
<pre><code class="language-toml">[template]
cargo_generate_version = "&gt;=0.10.0"
# ignore = [ "..." ]
# include = [ "..." ]
# exclude = [ "..." ]
...
</code></pre>
<p>This first part declares that the template requires <code>cargo-generate</code> version 0.10 or higher. In this same section the template author may also specify the following 3 lists:</p>
<ul>
<li><code>ignore</code> Files/folders on this list will be ignored entirely and are not included in the final output.</li>
<li><code>include</code> These files will be processed for <code>Liquid</code> syntax by the template engine.</li>
<li><code>exclude</code> These files will <em>not</em> be processed for any <code>liquid</code> syntax. The files will be in the final output.</li>
</ul>
<pre><code class="language-toml">...
[placeholders]
license = { type = "string", prompt = "What license to use?", choices = ["MIT", "Unrestricted"], default = "MIT" }
...
</code></pre>
<p>This is the section for the <em>default</em> placeholders. These are variable definitions that <code>cargo-generate</code> knows about and will query for if they are not provided e.g. on the commandline (see [Default-values-for-placeholders]).</p>
<p>The section should contain at least all variables used for any conditions (unless it's an automatic variable such as <code>crate_type</code>). All variables that are not specific to a condition are recommended to go here as well.</p>
<p>Here we simply define a variable <code>license</code> for selecting the desired license type.</p>
<pre><code class="language-toml">...
[conditional.'crate_type == "lib"']
ignore = [ "src/main.rs" ]
# include = [ "..." ]
# exclude = [ "..." ]
...
</code></pre>
<p>This is a conditional block.</p>
<p>Here it has been chosen that the <code>src/main.rs</code> file must be ignored when the <code>crate_type</code> variable is equal to the string <code>"lib"</code>.</p>
<pre><code class="language-toml">...
[conditional.'crate_type != "lib"'.placeholders]
hypervisor = { type = "string", prompt = "What hypervisor to use?", choices = ["uhyve", "qemu"], default = "qemu" }
network_enabled = { type = "bool", prompt = "Want to enable network?", default = true }
...
</code></pre>
<p>This block uses the same condition as the last, but it defines some extra placeholders - that is, is defines the variables <code>hypervisor</code> and <code>network_enabled</code>, so that <code>cargo-generate</code> may ask for their values.</p>
<blockquote>
<p>⚠️ <code>cargo-generate</code> will ask for values using the placeholders defined in <code>[placeholders]</code> before evaluating the conditional sections.</p>
<p>Placeholder values defined in conditional sections <strong>cannot</strong> be used to enable/disable further conditional sections, they can however still be used in the actual template!</p>
</blockquote>
<pre><code class="language-toml">...
[conditional.'license == "MIT"']
ignore = [ "LICENSE-UNRESTRICTED.txt" ]
# include = [ "..." ]
# exclude = [ "..." ]

[conditional.'license == "Unrestricted"']
ignore = [ "LICENSE-MIT.txt" ]
# include = [ "..." ]
# exclude = [ "..." ]
</code></pre>
<p>This last conditional block is simply to ignore the unneeded license files, based upon the users choice for the <code>license</code> variable.</p>
<blockquote>
<p>⚠️ Note that <code>include</code> and <code>exclude</code> are still mutually exclusive even if they are in different, but included, conditional sections.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="initprepost-scripts"><a class="header" href="#initprepost-scripts">Init/Pre/Post Scripts</a></h1>
<p><code>cargo-generate</code> can run scripts in the <a href="https://rhai.rs/book/"><code>Rhai</code></a> language as part of the template expansion.</p>
<p>Doing so requires the template is configured to use hooks, which can be used at specific times
during template expansion.</p>
<p>To configure the use of hooks, write a <code>hooks</code> section in the <code>cargo-generate.toml</code> file.</p>
<pre><code class="language-toml">[hooks]
init = ["init-script.rhai"]
pre = ["pre-script.rhai"]
post = ["post-script.rhai"]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="hook-types"><a class="header" href="#hook-types">Hook types</a></h2>
<h3 id="init"><a class="header" href="#init">Init</a></h3>
<ul>
<li>
<p>Init hooks are executed before anything else.</p>
</li>
<li>
<p>The variables <code>crate_type</code>/<code>authors</code>/<code>username</code>/<code>os-arch</code> and <code>is_init</code> are available.</p>
</li>
<li>
<p>The variable <code>project-name</code> <em>may</em> be available.</p>
<p>And only if <code>cargo-generate</code> was called with the <code>--init</code> flag, in which case it is the raw user input.</p>
</li>
<li>
<p>The variable <code>project-name</code> may be set - avoiding a user prompt!</p>
<p>The variable will still be subject for case changes to fit with the rust/cargo expectations.</p>
<p>The <code>--name</code> parameter still decides the final destination dir (together with the the <code>--init</code> flag),
in order not to confuse the user.</p>
</li>
</ul>
<h3 id="pre"><a class="header" href="#pre">Pre</a></h3>
<ul>
<li>
<p>Pre hooks are run <em>after all placeholders mentioned in cargo-generate.toml has been resolved</em>.</p>
</li>
<li>
<p>The hooks are free to add additional variables, but its too late to influence the conditional system.</p>
<p>This is a side effect of conditionals influencing the hooks - so placeholders need to be evaluated before the hooks are known.</p>
</li>
</ul>
<h3 id="post"><a class="header" href="#post">Post</a></h3>
<ul>
<li>Post hooks are run after template expansion, but <em>before final output is moved to the final destination</em>.</li>
</ul>
<p>Why not later? Security, and the fact that a failing script still causes no errors in the users destination.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="rhai-extensions"><a class="header" href="#rhai-extensions">Rhai extensions</a></h2>
<p>Besides the basic <a href="https://rhai.rs/book/"><code>Rhai</code></a> features, these are the modules/behaviors defined:</p>
<h3 id="variables-with-the-variable-module"><a class="header" href="#variables-with-the-variable-module">Variables with the <code>variable</code> module</a></h3>
<h4 id="getset"><a class="header" href="#getset">get/set</a></h4>
<ul>
<li>
<p><strong><code>variable::is_set(name: &amp;str) -&gt; bool</code></strong></p>
<p>Returns true if the variable/placeholder has been set for the template</p>
</li>
<li>
<p><strong><code>variable::get(name: &amp;str) -&gt; value</code></strong></p>
<p>Gets any defined variable in the <code>Liquid</code> template object</p>
</li>
<li>
<p><strong><code>variable::set(name: &amp;str, value: (&amp;str|bool))</code></strong></p>
<p>Set new or overwrite existing variables. Do not allow to change types.
Note that you can set entire arrays with this (e.g. <code>variable::set("array",["a","b"])</code>) but not individual elements (<code>variable::set("array[1]","a")</code> will not work).</p>
</li>
</ul>
<h4 id="prompt-for-values-with-variableprompt"><a class="header" href="#prompt-for-values-with-variableprompt">Prompt for values with <code>variable::prompt</code></a></h4>
<ul>
<li>
<p><strong><code>variable::prompt(text: &amp;str, default_value: bool) -&gt; value</code></strong></p>
<p>Prompt the user for a boolean value</p>
</li>
<li>
<p><strong><code>variable::prompt(text: &amp;str) -&gt; value</code></strong></p>
<p>Prompt the user for a string value</p>
</li>
<li>
<p><strong><code>variable::prompt(text: &amp;str, default_value: &amp;str) -&gt; value</code></strong></p>
<p>Prompt the user for a string value, with a default already in place</p>
</li>
<li>
<p><strong><code>variable::prompt(text: &amp;str, default_value: &amp;str, regex: &amp;str) -&gt; value</code></strong></p>
<p>Prompt the user for a string value, validated with a regex</p>
</li>
<li>
<p><strong><code>variable::prompt(text: &amp;str, default_value: &amp;str, choices: Array) -&gt; value</code></strong></p>
<p>Prompt the user for a choice value</p>
</li>
</ul>
<h3 id="files-with-the-file-module"><a class="header" href="#files-with-the-file-module">Files with the <code>file</code> module</a></h3>
<ul>
<li>
<p><strong><code>file::exists(path: &amp;str)</code></strong></p>
<p>Test if a path exists</p>
</li>
<li>
<p><strong><code>file::rename(from: &amp;str, to: &amp;str)</code></strong></p>
<p>Rename one of the files in the template folder</p>
</li>
<li>
<p><strong><code>file::delete(path: &amp;str)</code></strong></p>
<p>Delete a file or folder inside the template folder</p>
</li>
<li>
<p><strong><code>file::write(file: &amp;str, content: &amp;str)</code></strong></p>
<p>Create/overwrite a file inside the template folder</p>
</li>
<li>
<p><strong><code>file::write(file: &amp;str, content: Array)</code></strong></p>
<p>Create/overwrite a file inside the template folder, each entry in the array on a new line</p>
</li>
<li>
<p><strong><code>file::listdir(path = ".") -&gt; Array&lt;String&gt;</code></strong></p>
<p>List the contents of a directory</p>
<p>Note: The path is relative to the template folder, and cannot be outside the template folder.</p>
<p>Examples:</p>
<pre><code class="language-rhai">let files = file::listdir();
for f in files {
    print(`file: ${f}`);
}

// this is actually the same as above, the path must be inside the template directory, cannot be absolute or ourside
let files = file::listdir(".");
for f in files {
    print(`file: ${f}`);
}
</code></pre>
<p>See also: <a href="https://github.com/cargo-generate/cargo-generate/blob/main/example-templates/many-hooks-in-action/sed-license.rhai#L18">the many-hooks-in-action example project</a></p>
</li>
</ul>
<h3 id="the-system-module"><a class="header" href="#the-system-module">The <code>system</code> module</a></h3>
<ul>
<li>
<p><strong><code>system::command(cmd: &amp;str, args: Array = []) -&gt; value</code></strong></p>
<p>Execute a command on the system generating the project from a template.</p>
<p>The user will be prompted with</p>
<pre><code>The template is requesting to run the following command. Do you agree?
&lt;command&gt; &lt;args&gt;
</code></pre>
<p>unless the user uses the flag <code>--allow-commands</code>. If the user attempts to use the
<code>--silent</code> flag without the <code>--allow-commands</code> flag will fail.</p>
<p>Examples:</p>
<pre><code class="language-rhai">// this returns the PWD as a string
let pwd = system::command("pwd");

// but this works too and does the same
system::command("pwd", []);

// this will cat a file and returns the content
let content = system::command("cat", ["file.txt"]);
</code></pre>
<p>See also: <a href="https://github.com/cargo-generate/cargo-generate/blob/main/example-templates/many-hooks-in-action/sed-license.rhai#L11">the many-hooks-in-action example project</a></p>
</li>
<li>
<p><strong><code>system::date() -&gt; Date</code></strong></p>
<p>Get the date in UTC from the system as an object with the properties <code>year</code>, <code>month</code>, and <code>day</code>.</p>
</li>
</ul>
<h3 id="the-env-module"><a class="header" href="#the-env-module">The <code>env</code> module</a></h3>
<p>The <code>env</code> module provides access to environment variables.</p>
<ul>
<li>
<p><strong><code>env::working_directory</code></strong></p>
<p>Returns the current working directory as a string. This is the directory where the <code>cargo-generate</code> pre-processes the template, before it is copied over to the users <code>destination</code> directory.</p>
<p>Examples:</p>
<pre><code class="language-rhai">let wd = env::working_directory;
print(`Working directory: ${wd}`);
</code></pre>
<p>See also: <a href="https://github.com/cargo-generate/cargo-generate/blob/main/example-templates/many-hooks-in-action/post-script.rhai#L6">the many-hooks-in-action example project</a></p>
</li>
<li>
<p><strong><code>env::destination_directory</code></strong></p>
<p>Returns the destination directory as a string. This is the directory where the template is copied to, and where the user will find the generated project.</p>
<p>Examples:</p>
<pre><code class="language-rhai">let dd = env::destination_directory;
print(`Destination directory: ${dd}`);
</code></pre>
</li>
</ul>
<h3 id="other"><a class="header" href="#other">Other</a></h3>
<ul>
<li><strong><code>abort(reason: &amp;str)</code></strong>: Aborts <code>cargo-generate</code> with a script error.</li>
</ul>
<h4 id="changing-case-of-strings"><a class="header" href="#changing-case-of-strings">Changing case of strings</a></h4>
<ul>
<li>
<p><strong><code>to_kebab_case(str: &amp;str) -&gt; String</code></strong></p>
<p><code>"We are going to inherit the earth."</code> =&gt; <code>"we-are-going-to-inherit-the-earth"</code></p>
</li>
<li>
<p><strong><code>to_lower_camel_case(str: &amp;str) -&gt; String</code></strong></p>
<p><code>"It is we who built these palaces and cities."</code> =&gt; <code>"itIsWeWhoBuiltThesePalacesAndCities"</code></p>
</li>
<li>
<p><strong><code>to_pascal_case(str: &amp;str) -&gt; String</code></strong></p>
<p>Same as <code>to_upper_camel_case(str: &amp;str) -&gt; String</code></p>
</li>
<li>
<p><strong><code>to_shouty_kebab_case(str: &amp;str) -&gt; String</code></strong></p>
<p><code>"We are going to inherit the earth."</code> =&gt; <code>"WE-ARE-GOING-TO-INHERIT-THE-EARTH"</code></p>
</li>
<li>
<p><strong><code>to_shouty_snake_case(str: &amp;str) -&gt; String</code></strong></p>
<p><code>"That world is growing in this minute."</code> =&gt; <code>"THAT_WORLD_IS_GROWING_IN_THIS_MINUTE"</code></p>
</li>
<li>
<p><strong><code>to_snake_case(str: &amp;str) -&gt; String</code></strong></p>
<p><code>"We carry a new world here, in our hearts."</code> =&gt; <code>"we_carry_a_new_world_here_in_our_hearts"</code></p>
</li>
<li>
<p><strong><code>to_title_case(str: &amp;str) -&gt; String</code></strong></p>
<p><code>"We have always lived in slums and holes in the wall."</code> =&gt; <code>"We Have Always Lived In Slums And Holes In The Wall"</code></p>
</li>
<li>
<p><strong><code>to_upper_camel_case(str: &amp;str) -&gt; String</code></strong></p>
<p><code>"We are not in the least afraid of ruins."</code> =&gt; <code>"WeAreNotInTheLeastAfraidOfRuins"</code></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="mini-example"><a class="header" href="#mini-example">Mini Example</a></h2>
<p>In <code>cargo-generate.toml</code> write a <code>[hooks]</code> section:</p>
<pre><code class="language-toml">[template]
cargo_generate_version = "0.10.0"

[hooks]
#init = [...]
pre = ["pre-script.rhai"]
#post = [...]

[placeholders]
license = { type = "string", prompt = "What license to use?", choices = ["APACHE", "MIT"], default = "MIT" }
</code></pre>
<p>Now, write the script in <a href="https://rhai.rs/book/"><code>Rhai</code></a>, utilizing the <code>cargo-generate</code> <a href="templates/scripting.mini-example.html#Rhai-extensions">provided extensions</a>:</p>
<pre><code class="language-rhai">// we can see existing variables.
// note that template and Rhai variables are separate!
let crate_type = variable::get("crate_type")
debug(`crate_type: ${crate_type}`);

let license = variable::get("license").to_upper();
while switch license {
  "APACHE" =&gt; {
    file::delete("LICENSE-MIT");
    file::rename("LICENSE-APACHE", "LICENSE");
    false
  }
  "MIT" =&gt; {
    file::delete("LICENSE-APACHE");
    file::rename("LICENSE-MIT", "LICENSE");
    false
  }
  _ =&gt; true,
} {
  license = variable::prompt("Select license?", "MIT", [
    "APACHE",
    "MIT",
  ]);
}
variable::set("license", license);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="template-authoring"><a class="header" href="#template-authoring">Template Authoring</a></h1>
<blockquote>
<p>Available since version <a href="https://github.com/cargo-generate/cargo-generate/releases/tag/v0.9.0">0.9.0</a></p>
</blockquote>
<p>As a template author you're probably concerned about successful builds of your template.</p>
<p>Imagine a couple of months after your first template release, some new versions of any dependencies
would break your template, and you would not even be aware of it?</p>
<p>The answer to this question is a vital build pipeline for your template project. This challenge got now
much simpler to solve with the new official <a href="https://github.com/marketplace/actions/cargo-generate">cargo-generate GitHub Action</a>.</p>
<p>Here is an example:</p>
<pre><code class="language-sh">tree .github
.github
└── workflows
    └── build.yml
</code></pre>
<p>The content of <code>build.yml</code> as a paste template:</p>
<pre><code class="language-yaml">name: Build Template
on:
  # https://docs.github.com/en/actions/reference/events-that-trigger-workflows#workflow_dispatch
  workflow_dispatch:
  schedule:
    - cron: '0 18 * * 5'
  push:
    branches: [ '*' ]
    paths-ignore:
      - "**/docs/**"
      - "**.md"

jobs:
  build:
    runs-on: ubuntu-latest
    env:
      PROJECT_NAME: mytemplate
    steps:
      - uses: actions/checkout@v4
      - uses: cargo-generate/cargo-generate-action@latest
        with:
          name: ${{ env.PROJECT_NAME }}
      - uses: dtolnay/rust-toolchain@stable
        with:
          toolchain: stable
      # we need to move the generated project to a temp folder, away from the template project
      # otherwise `cargo` runs would fail 
      # see https://github.com/rust-lang/cargo/issues/9922
      - run: |
          mv $PROJECT_NAME ${{ runner.temp }}/
          cd ${{ runner.temp }}/$PROJECT_NAME
          cargo check
</code></pre>
<p>This is a very simple pipeline that builds weekly and on push.
It processes your template repo and runs a <code>cargo check</code> as the final step. That's it, a good start to build on.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="common-pitfalls"><a class="header" href="#common-pitfalls">Common Pitfalls</a></h1>
<p>When creating templates with <code>cargo-generate</code>, there are several common issues and pitfalls that template authors may encounter. This section aims to highlight these issues and provide guidance on how to avoid them.</p>
<h2 id="github-actions-and-liquid-template-language-interference"><a class="header" href="#github-actions-and-liquid-template-language-interference">GitHub Actions and Liquid Template Language Interference</a></h2>
<p>GitHub Actions use their own templating language, which can interfere with the Liquid template language used by <code>cargo-generate</code>. This can lead to unexpected behavior when placeholders are used in GitHub Actions workflow files.</p>
<h3 id="issue"><a class="header" href="#issue">Issue</a></h3>
<p>When using placeholders in GitHub Actions workflow files, the syntax for GitHub Actions (<code>${{ ... }}</code>) can conflict with the Liquid syntax (<code>{{ ... }}</code>). This can cause errors or unexpected behavior during template generation.</p>
<p>For more details, you can refer to the <a href="https://github.com/cargo-generate/cargo-generate/discussions/843">discussion</a> that was opened for this purpose.</p>
<h3 id="workarounds"><a class="header" href="#workarounds">Workarounds</a></h3>
<ol>
<li>
<p><strong>Escape Liquid Syntax</strong>: One way to avoid conflicts is to escape the Liquid syntax in the workflow files. This can be done by using <code>{% raw %}</code> and <code>{% endraw %}</code> tags around the GitHub Actions syntax.</p>
<pre><code class="language-yaml">jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Run cargo-generate
        run: |
          cargo generate --git https://github.com/your/repo.git --name ${{ '{% raw %}' }}{{ project-name }}{% endraw %}
</code></pre>
</li>
<li>
<p><strong>Use Different Placeholders</strong>: Another approach is to use different placeholders for GitHub Actions and Liquid. For example, you can use a different syntax for placeholders in GitHub Actions and then replace them with the correct values in a pre-processing step.</p>
<pre><code class="language-yaml">jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Set up project
        run: |
          PROJECT_NAME={{ project-name }}
          echo "Project name is $PROJECT_NAME"
</code></pre>
</li>
<li>
<p><strong>Use <code>cargo-generate</code> Placeholders Sparingly</strong>: Limit the use of <code>cargo-generate</code> placeholders in GitHub Actions workflow files to only where necessary. This reduces the chances of conflicts and makes the workflow files easier to manage.</p>
</li>
<li>
<p><strong>Liquid Prepend and Append</strong>: Use Liquid's <code>prepend</code> and <code>append</code> filters to dynamically generate the GitHub Actions syntax. This ensures that the placeholders are correctly processed by Liquid and result in the correct GitHub Actions markup.</p>
<pre><code class="language-yaml">jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Set up project
        run: |
          echo "${{ "github-variable" | prepend: "{{" | append: "}}" }}"
</code></pre>
</li>
<li>
<p><strong>Pre-Hook Rhai Script</strong>: Another solution is to create a pre-hook Rhai script that executes <code>gsed</code> or <code>sed</code> to replace all GitHub Actions placeholders with the Liquid syntax on the fly. This automates the escaping process.</p>
<pre><code class="language-toml">[hooks]
pre = ["pre-hook.rhai"]
</code></pre>
<pre><code class="language-rhai">// pre-hook.rhai
let result = system::command("gsed", ["-i", 's/${{ /${{ "{{" | prepend: "{{" | append: "}}" }}/g', "path/to/workflow/file.yml"]);
if result != 0 {
    abort("Failed to replace GitHub Actions placeholders");
}
</code></pre>
<p>For more details, you can refer to the <a href="https://github.com/cargo-generate/cargo-generate/issues/1387#issuecomment-2691737440">issue</a> that was opened for this.</p>
</li>
</ol>
<h2 id="undefined-placeholders"><a class="header" href="#undefined-placeholders">Undefined Placeholders</a></h2>
<p>Another common pitfall is using placeholders that are not defined. When a placeholder is not defined, <code>cargo-generate</code> will not throw an error; instead, it will replace the placeholder with an empty string. This can lead to unexpected results in the generated files.</p>
<h3 id="issue-1"><a class="header" href="#issue-1">Issue</a></h3>
<p>If a placeholder is used in a template file but is not defined in the <code>cargo-generate.toml</code> file or provided by the user, it will be replaced with an empty string. This can cause issues such as missing values in configuration files or broken code.</p>
<h3 id="solution"><a class="header" href="#solution">Solution</a></h3>
<ol>
<li>
<p><strong>Define All Placeholders</strong>: Ensure that all placeholders used in the template files are defined in the <code>cargo-generate.toml</code> file. This includes providing default values or prompting the user for input.</p>
<pre><code class="language-toml">[placeholders]
project_name = { prompt = "Enter project name", default = "my_project", type = "string" }
author_name = { prompt = "Enter author name", default = "John Doe", type = "string" }
</code></pre>
</li>
<li>
<p><strong>Validate Placeholder Usage</strong>: Before generating the template, validate that all placeholders used in the template files are defined. This can be done by reviewing the template files and cross-referencing them with the placeholders defined in the <code>cargo-generate.toml</code> file.</p>
</li>
<li>
<p><strong>Provide Default Values</strong>: Where possible, provide default values for placeholders to ensure that they are always replaced with meaningful values.</p>
<pre><code class="language-toml">[placeholders]
project_name = { prompt = "Enter project name", default = "my_project", type = "string" }
</code></pre>
</li>
</ol>
<p>By being aware of these common issues and pitfalls, template authors can create more robust and reliable templates with <code>cargo-generate</code>. Proper handling of GitHub Actions and Liquid template language interference, as well as ensuring that all placeholders are defined, will help avoid unexpected behavior and improve the overall template generation experience.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contributing"><a class="header" href="#contributing">Contributing</a></h1>
<p>Unless you explicitly state otherwise, any contribution intentionally
submitted for inclusion in the work by you, as defined in the Apache-2.0
license, shall be dual licensed as noted in <a href="license.html">License</a>, without any additional terms or
conditions.
If you want to contribute to <code>cargo-generate</code>, please see <a href="https://github.com/cargo-generate/cargo-generate/blob/6085896e7025bdbd5690a8cb2b3d4259cf9f825f/CONTRIBUTING.md">CONTRIBUTING.md</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="license"><a class="header" href="#license">License</a></h1>
<p>Licensed, at your option, under either of the following licences:</p>
<ul>
<li>Apache License, Version 2.0, (<a href="https://github.com/cargo-generate/cargo-generate/blob/main/LICENSE-APACHE">LICENSE-APACHE</a> or <a href="https://www.apache.org/licenses/LICENSE-2.0">apache.org/licenses/LICENSE-2.0</a>)</li>
<li>MIT license (<a href="https://github.com/cargo-generate/cargo-generate/blob/main/LICENSE-MIT">LICENSE-MIT</a> or <a href="https://opensource.org/licenses/MIT">opensource.org/licenses/MIT</a>)</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
